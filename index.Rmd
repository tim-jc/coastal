---
title: "ph√Øets::coasting"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: fill
    theme: 
      version: 4
      navbar-bg: "#0C2340"
    navbar: 
    - { icon: "fa-circle", href: "http://phiets.cc", align: right}
    - { icon: "fa-circle", href: "http://phiets.cc", align: right}
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(plotly)
library(leaflet)

# clear the memory
rm(list=ls(all = TRUE))

source("coastal_vis_functions.R")

load_gps_data(file_location = "gps_data/csv_files/")

rides_index <- create_summary()
```

Row {data-width=1000}
-----------------------------------------------------------------------

### Miles ridden

```{r}
valueBox(rides_index$distance_miles %>% sum() %>% floor(), icon = "fa-bicycle", color = "grey25")
```

### Metres climbed

```{r}
valueBox(rides_index$elevation_metres %>% sum() %>% floor(), icon = "fa-caret-up", color = "grey25")
```

### Days ridden

```{r}
valueBox(rides_index$start_datetime %>% as.Date() %>% unique() %>% length(), icon = "fa-sun", color = "grey25")
```

### Ferries taken

```{r}
valueBox("8", icon = "fa-ship", color = "grey25")
```

Row 
-----------------------------------------------------------------------

### Map {data-width=600}

```{r}
leaflet() %>% 
  addTiles('https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}.png',
    attribution = paste(
      '&copy; <a href="https://openstreetmap.org">OpenStreetMap</a> contributors',
      '&copy; <a href="https://cartodb.com/attributions">CartoDB</a>'
    )) %>% 
  add_track(full_dataset) %>% 
  addMarkers(data = rides_index, lng = ~start_lon, lat = ~start_lat, popup = ~marker_popup, label = ~ride_pretty, clusterOptions = markerClusterOptions())
```

### Contributors {data-width=400}

```{r}
draw_xp_plot()
```
